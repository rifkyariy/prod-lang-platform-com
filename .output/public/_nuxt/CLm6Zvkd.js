import{P as Z}from"./BP8UTi2G.js";import{_ as ee}from"./CizdsbHW.js";import{_ as te}from"./B6lnNECk.js";import{_ as se}from"./ki6bLwiE.js";import{x as oe,f as le,J as ae,K as O,r as u,G as L,g as ne,h as ie,c as i,l as re,a as s,b as t,d as p,i as f,w as a,T as de,o as n,t as N,y as A,p as ue}from"./BEkH225l.js";import{_ as ce}from"./DCO7bsHh.js";import{_ as me}from"./DeYLDte9.js";import{w as ge,l as D}from"./Z7mOtvVJ.js";import{c as I,a as w,b as pe}from"./BFQTJ8AU.js";import{useTokenClient as fe}from"./V81K9Avm.js";import"./DJQezgFW.js";import"./DwxjmMYL.js";const ve=()=>{const{$axios:m}=oe();return{login(g){return m.post("/auth/login",g)},register(g){return m.post("/auth/register",g)},logout(){return m.post("/auth/logout")},getUser(){return m.get("/auth/user")},getTestData(){return m.get("/test")},verifyGoogleToken(g){return m.post("/auth/sso/google/verify",g)}}},xe={key:1,class:"flex justify-center items-center min-h-screen background p-4 md:p-0"},_e={class:"bg-white rounded-lg shadow-md w-full md:w-auto grid grid-cols-1 md:grid-cols-2 gap-2"},ye={class:"flex flex-col justify-between bg-accent rounded-t-lg md:rounded-l-lg md:rounded-tr-none"},he={class:"grow w-full flex flex-col items-center justify-center p-4"},we=["src"],be={class:"relative w-full px-3"},ke={key:"login",class:"px-4 md:px-10 py-8"},Ve=["src"],qe={class:"text-2xl font-bold my-6 text-primary text-center md:text-left"},Ce={class:"relative"},Pe={key:0,class:"flex items-center gap-1"},Se={key:1,class:"flex items-center gap-1"},Le=["disabled"],Ue={class:"mt-4 flex justify-between text-sm text-gray-600"},Te={key:"register",class:"px-4 md:px-10 py-8"},Ee=["src"],Re={class:"text-2xl font-bold my-6 text-primary text-center md:text-left"},$e={class:"relative"},je={key:0,class:"flex items-center gap-1"},Ge={key:1,class:"flex items-center gap-1"},Be={class:"relative"},Fe={key:0,class:"flex items-center gap-1"},Oe={key:1,class:"flex items-center gap-1"},Ne=["disabled"],Ae={class:"mt-4 flex justify-between text-sm text-gray-600"},st={__name:"login",setup(m){const{login:g,register:M,verifyGoogleToken:Y}=ve(),v=le(),V=ae();O();const{as:b,type:J}=O().query,x=u(""),_=u(""),C=u(""),P=u("");L("token");const q=u("login"),U=u(!0),r=u(!1),c=u(!1),K=I().shape({email:w().email("Invalid email").required("Email is required"),password:w().required("Password is required")}),z=I().shape({fullname:w().required("Full name is required"),email:w().email("Invalid email").required("Email is required"),password:w().required("Password is required"),confirmPassword:w().oneOf([pe("password"),null],"Passwords must match").required("Confirm password is required")}),T=o=>{q.value=o,V.push({query:{as:b,type:o}})},E=async()=>{r.value=!0;const o={email:x.value,password:_.value};await g(o).then(e=>{const k=L("token");k.value=e.data.data,r.value=!1,v.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"You have successfully logged in!"}),V.push("/")}).catch(e=>{console.error(e),v.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:e.response.data.error}),r.value=!1})},H=async()=>{r.value=!0;const o={fullname:P.value,email:x.value,password:_.value,password_confirmation:C.value,as:b==="facilitator"?"facilitator":"client"};await M(o).then(e=>{v.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"You have successfully registered!"}),E()}).catch(e=>{r.value=!1,console.error(e),v.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:Q(e.response.data.error)})})},Q=o=>{for(const e in o)if(o[e].length>0)return o[e][0];return null},W=o=>{V.push(o)},S=()=>{c.value=!c.value},X=async o=>{await Y({token:o,as:b}).then(e=>{console.log("Google Token:",e);const k=L("token");k.value=e.data.data,r.value=!1,v.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"You have successfully logged in!"}),V.push("/")}).catch(e=>{console.error(e),v.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:e.response.data.error}),r.value=!1})},R=fe({onSuccess:async o=>{const{access_token:e}=o;console.log("Access Token",e),await X(e)},onError:()=>{console.error("Login failed")}}),$=async()=>{R.login()},j=u(R.isReady);return ne(()=>J,o=>{o==="register"?q.value="register":q.value="login"},{immediate:!0}),ie(()=>{U.value=!1}),(o,e)=>{const k=Z,d=ee,y=te,h=se,G=ue,B=ce,F=me;return n(),i("div",null,[U.value?(n(),re(k,{key:0})):(n(),i("div",xe,[s("div",_e,[s("div",ye,[s("button",{class:"flex gap-2 items-center justify-start mx-8 mt-8 text-white",onClick:e[0]||(e[0]=l=>W("/"))},[t(d,{name:"back",class:"text-white"}),e[11]||(e[11]=p(" Back "))]),s("div",he,[s("img",{src:f(ge),class:"w-full max-w-[300px] hidden md:flex"},null,8,we)])]),s("div",be,[t(de,{name:"fade",mode:"out-in"},{default:a(()=>[q.value==="login"?(n(),i("div",ke,[s("img",{src:f(D),class:"my-4 w-32 mx-auto md:mx-0"},null,8,Ve),s("h1",qe," Login "+N(f(b)==="facilitator"?"as Facilitator":""),1),t(B,{"validation-schema":f(K),onSubmit:E},{default:a(()=>[t(h,{name:"email",label:"Email",class:"mb-2"},{default:a(()=>[t(y,{type:"email",modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=l=>x.value=l),required:"",class:"w-full"},null,8,["modelValue"])]),_:1}),t(h,{name:"password",label:"Password",class:"mb-2"},{default:a(()=>[s("div",Ce,[t(y,{type:c.value?"text":"password",modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=l=>_.value=l),required:"",class:"w-full"},null,8,["type","modelValue"]),s("button",{type:"button",onClick:S,class:"absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5"},[c.value?(n(),i("span",Pe,[t(d,{name:"eye-off",filled:"",class:"text-lg"})])):(n(),i("span",Se,[t(d,{name:"eye",filled:"",class:"text-lg"})]))])])]),_:1}),t(G,{type:"submit",loading:r.value,block:"",class:"w-full bg-blue-500 text-white text-center py-2 rounded-md hover:bg-blue-600"},{default:a(()=>e[12]||(e[12]=[p(" Login ")])),_:1},8,["loading"])]),_:1},8,["validation-schema"]),t(F,{label:"OR",class:"py-2 mt-4"}),s("button",{class:"w-full bg-white py-2 rounded-md flex gap-2 justify-center items-center border-2 border-gray-100",disabled:!j.value,onClick:e[3]||(e[3]=()=>$())},[t(d,{name:"google",filled:""}),e[13]||(e[13]=p(" Continue with Google "))],8,Le),s("p",Ue,[e[14]||(e[14]=p(" Don't have an account? ")),s("a",{href:"#",onClick:e[4]||(e[4]=A(l=>T("register"),["prevent"])),class:"text-blue-500 hover:underline"}," Register ")])])):(n(),i("div",Te,[s("img",{src:f(D),class:"my-4 w-32 mx-auto md:mx-0"},null,8,Ee),s("h1",Re," Register "+N(f(b)==="facilitator"?"as Facilitator":""),1),t(B,{"validation-schema":f(z),onSubmit:H},{default:a(()=>[t(h,{name:"fullname",label:"Full Name",class:"mb-2"},{default:a(()=>[t(y,{modelValue:P.value,"onUpdate:modelValue":e[5]||(e[5]=l=>P.value=l),required:"",class:"w-full"},null,8,["modelValue"])]),_:1}),t(h,{name:"email",label:"Email",class:"mb-2"},{default:a(()=>[t(y,{type:"email",modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=l=>x.value=l),required:"",class:"w-full"},null,8,["modelValue"])]),_:1}),t(h,{name:"password",label:"Password",class:"mb-2"},{default:a(()=>[s("div",$e,[t(y,{type:c.value?"text":"password",modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=l=>_.value=l),required:"",class:"w-full"},null,8,["type","modelValue"]),s("button",{type:"button",onClick:S,class:"absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5"},[c.value?(n(),i("span",je,[t(d,{name:"eye-off",filled:"",class:"text-lg"})])):(n(),i("span",Ge,[t(d,{name:"eye",filled:"",class:"text-lg"})]))])])]),_:1}),t(h,{name:"confirmPassword",label:"Confirm Password",class:"mb-2"},{default:a(()=>[s("div",Be,[t(y,{type:c.value?"text":"password",modelValue:C.value,"onUpdate:modelValue":e[8]||(e[8]=l=>C.value=l),required:"",class:"w-full"},null,8,["type","modelValue"]),s("button",{type:"button",onClick:S,class:"absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5"},[c.value?(n(),i("span",Fe,[t(d,{name:"eye-off",filled:"",class:"text-lg"})])):(n(),i("span",Oe,[t(d,{name:"eye",filled:"",class:"text-lg"})]))])])]),_:1}),t(G,{type:"submit",loading:r.value,block:"",class:"w-full bg-blue-500 text-white text-center py-2 rounded-md hover:bg-blue-600"},{default:a(()=>e[15]||(e[15]=[p(" Sign Up ")])),_:1},8,["loading"])]),_:1},8,["validation-schema"]),t(F,{label:"OR",class:"py-2 mt-4"}),s("button",{class:"w-full bg-white py-2 rounded-md flex gap-2 justify-center items-center border-2 border-gray-100",disabled:!j.value,onClick:e[9]||(e[9]=()=>$())},[t(d,{name:"google",filled:""}),e[16]||(e[16]=p(" Continue with Google "))],8,Ne),s("p",Ae,[e[17]||(e[17]=p(" Already have an account? ")),s("a",{href:"#",onClick:e[10]||(e[10]=A(l=>T("login"),["prevent"])),class:"text-blue-500 hover:underline"}," Login ")])]))]),_:1})])])]))])}}};export{st as default};

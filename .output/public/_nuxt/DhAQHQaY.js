import{E as oe,D as se,G as W,o as i,l as q,w as c,b as s,a as t,i as re,t as v,d as $,c as d,F as D,s as z,q as E,v as xe,p as le,e as ye,x as he,f as we,r as f,Q as T,g as J,h as be,m as ke,z as K,A as Ce,B as ne,C as Se}from"./XJk57Xzm.js";import{_ as Fe}from"./25-c76kT.js";import{_ as Le}from"./BzDEtBN7.js";import{_ as $e}from"./CBafb-BA.js";import{_ as ie}from"./BNtHcZP4.js";import{_ as Ee,a as Oe}from"./t4TcopXV.js";import{P as Ue}from"./CaKezGkQ.js";import{_ as je}from"./brHeAYbW.js";import{_ as Ve}from"./CrKBm7Us.js";import{_ as Pe}from"./0oq0bqkJ.js";import{u as Ie}from"./Ck55vBbv.js";import{_ as Te}from"./ZQ9ovho2.js";import{u as qe,a as Re}from"./DLXSBfRA.js";import{u as Ne}from"./1KzAzcSR.js";import"./BQdhZYq_.js";import"./DKK-teFl.js";import"./Y56T3AGQ.js";import"./DEmq8X_o.js";import"./ZSbHdXa8.js";import"./CV2JBMnn.js";import"./B4_BqFOv.js";import"./whFIgR0T.js";import"./viV4BwKR.js";import"./Cg8Mu8Bz.js";const De=""+new URL("facilitators-blue-bg.C_ME9o-k.png",import.meta.url).href,ze={class:"flex flex-col items-center"},Me=["src"],Ae={class:"font-semibold py-2 capitalize text-center"},Be={class:"flex flex-col lg:flex-row gap-4 items-center py-2 text-center sm:text-left"},He={key:0,class:"flex gap-2"},Ge={key:1,class:"flex gap-2"},Qe={key:2,class:"flex gap-2"},We={class:"text-sm cursor-pointer"},Ye={class:"flex gap-2 items-center lg:border-x border-gray-900 px-6"},Je={class:"w-full grid grid-cols-1 sm:grid-cols-3 gap-4 py-2 pb-6 px-8"},Ke={__name:"FacilitatorCard",props:{data:{type:Object,required:!0},callback:{type:Function,required:!0}},emits:["order"],setup(X,{emit:Y}){var j,V;const{$supabase:y}=he(),O=Ie();oe();const M=se(),A=Y,u=X,C=(r,o)=>r==="order"&&(!o.language_sources||o.language_sources.length===0)||r==="chat"&&o.merchants[0].users[0].id===F,S=r=>{M.push(r)},R=()=>{A("order")},b=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(r);let F=null;const k=W("token");if(k.value)try{F=((V=(j=k.value)==null?void 0:j.user)==null?void 0:V.chat_owner_id)||null}catch(r){console.error("Error parsing token:",r)}const B=async()=>{var L,I;const r={id:(I=(L=k.value)==null?void 0:L.user)==null?void 0:I.chat_owner_id,fullname:k.value.user.fullname,photo:k.value.user.photo},o={id:u.data.merchants[0].users[0].id,fullname:u.data.merchants[0].users[0].fullname,photo:u.data.merchants[0].users[0].photo};O.openChat(),O.isChatLoading=!0;const{data:h,error:_}=await y.from("contacts").select("*").eq("owner_id",r.id);if(_&&console.error("Error fetching owner contact:",_),h.length===0){const{data:U,error:p}=await y.from("contacts").insert([{owner_id:r.id,contacts:[{is_read:!1,is_active:!0,recipient_id:o.id,recipient_name:o.fullname,recipient_picture:o.photo,recipient_last_chat:"",recipient_last_chat_datetime:"",recipient_is_open:!1,recipient_unread_count:0}]}]);p&&console.error("Error creating new owner contact:",p)}else if(h[0].contacts.find(p=>p.recipient_id===o.id)){const{data:p,error:m}=await y.from("contacts").update({contacts:h[0].contacts.map(x=>x.recipient_id===o.id?{...x,recipient_last_chat_datetime:new Date().toISOString(),recipient_is_open:!1}:x)}).eq("owner_id",r.id);m&&console.error("Error updating recipient contact:",m)}else{const{data:p,error:m}=await y.from("contacts").update({contacts:[...h[0].contacts,{is_read:!1,is_active:!0,recipient_id:o.id,recipient_name:o.fullname,recipient_picture:o.photo,recipient_last_chat:"",recipient_last_chat_datetime:"",recipient_is_open:!1}]}).eq("owner_id",r.id);m&&console.error("Error creating new recipient contact:",m)}const{data:n,error:P}=await y.from("contacts").select("*").eq("owner_id",o.id);if(P&&console.error("Error fetching recipient contact:",P),n.length===0){const{data:U,error:p}=await y.from("contacts").insert([{owner_id:o.id,contacts:[{is_read:!1,is_active:!0,recipient_id:r.id,recipient_name:r.fullname,recipient_picture:r.photo,recipient_last_chat:"",recipient_last_chat_datetime:"",recipient_is_open:!1,recipient_unread_count:0}]}]);p&&console.error("Error creating new recipient contact:",p)}else if(n[0].contacts.find(p=>p.recipient_id===r.id)){const{data:p,error:m}=await y.from("contacts").update({contacts:n[0].contacts.map(x=>x.recipient_id===r.id?{...x,recipient_last_chat_datetime:new Date().toISOString(),recipient_is_open:!1}:x)}).eq("owner_id",o.id);m&&console.error("Error updating owner contact:",m)}else{const{data:p,error:m}=await y.from("contacts").update({contacts:[...n[0].contacts,{is_read:!1,is_active:!0,recipient_id:r.id,recipient_name:r.fullname,recipient_picture:r.photo,recipient_last_chat:"",recipient_last_chat_datetime:"",recipient_is_open:!1}]}).eq("owner_id",o.id);m&&console.error("Error creating new owner contact:",m)}O.setChatRecipient(o),O.setChatOwner(r),O.isChatLoading=!1};return(r,o)=>{const h=xe,_=Ve,n=Ee,P=Pe,L=le,I=ie,U=ye;return i(),q(U,null,{default:c(()=>[s(I,{ui:{rounded:"rounded-xl",body:{base:"",background:"",padding:""}}},{default:c(()=>[t("div",ze,[t("img",{src:re(De),alt:"Facilitator Banner",class:"w-full h-24 object-cover rounded-t-xl"},null,8,Me),s(h,{size:"3xl",alt:u.data.merchants[0].users[0].fullname,src:u.data.merchants[0].users[0].photo,imgClass:"object-cover",class:"-mt-10"},null,8,["alt","src"]),t("h2",Ae,v(u.data.merchants[0].users[0].fullname),1),s(_,{variant:"soft",size:"sm",color:u.data.merchants[0].type==="interpreter"?"orange":"green",class:"text-sm uppercase"},{default:c(()=>[$(v(u.data.merchants[0].type),1)]),_:1},8,["color"]),t("div",Be,[u.data.languages.length===0?(i(),d("div",He,o[1]||(o[1]=[t("span",{class:"text-sm"}," No Language ",-1)]))):u.data.languages.length<=2?(i(),d("div",Ge,[(i(!0),d(D,null,z(u.data.languages,(p,m)=>(i(),d("span",{key:m,class:"text-sm"},v(p.name),1))),128))])):(i(),d("div",Qe,[s(n,null,{text:c(()=>[(i(!0),d(D,null,z(u.data.languages,(p,m)=>(i(),d("span",{key:m},v(`${p.name} `),1))),128))]),default:c(()=>[t("span",We,v(u.data.languages.length)+" Languages ",1)]),_:1})])),t("div",Ye,[s(P,{name:"star",class:"text-2xl",filled:""}),t("strong",null,v(u.data.merchants[0].rating),1)]),t("div",null,[t("strong",null,v(b(u.data.price)),1)])]),t("div",Je,[s(L,{block:"",variant:"outline",color:"orange",class:E(["rounded-full",C("order",u.data)?"cursor-not-allowed":"hover:bg-accent hover:text-white"]),disabled:C("order",u.data),onClick:R},{default:c(()=>o[2]||(o[2]=[t("span",null,"Order ",-1)])),_:1},8,["class","disabled"]),s(L,{block:"",variant:"outline",color:"orange",class:"rounded-full hover:bg-accent hover:text-white",onClick:o[0]||(o[0]=p=>S({name:"facilitators-id",params:{id:u.data.merchants[0].id}}))},{default:c(()=>o[3]||(o[3]=[t("span",null," Profile",-1)])),_:1}),s(L,{block:"",variant:"outline",color:"orange",class:E(["rounded-full",C("chat",u.data)?"cursor-not-allowed":"hover:bg-accent hover:text-white"]),disabled:C("chat",u.data),onClick:B},{default:c(()=>o[4]||(o[4]=[t("span",null,"Chat",-1)])),_:1},8,["class","disabled"])])])]),_:1})]),_:1})}}},Xe=""+new URL("empty.CcfrYBV1.svg",import.meta.url).href,Ze={class:"bg-[#E4F1F7] min-h-screen h-full"},et={key:1,class:"w-100"},tt={class:"p-8 lg:px-36 pt-20"},at={class:"flex justify-center py-8 gap-2"},nt={class:"grid grid-cols-12 gap-6"},ot={class:"overflow-y-auto pl-1 pr-4 h-fit-screen"},st={class:"flex gap-2 mt-2 flex-wrap"},rt={class:"flex justify-between items-center"},lt={class:"font-semibold text-primary capitalize mb-1"},it=["value"],ct={class:"ml-2 text-gray-700"},ut={key:1,class:"flex gap-1 justify-center py-4"},dt={class:"mt-2"},pt=["value"],mt={class:"ml-2 text-gray-700"},ft={key:1,class:"flex gap-1 justify-center py-4"},vt={class:"mt-2"},_t={class:"mt-2"},gt={class:"flex justify-between"},xt={class:"text-accent"},yt={class:"text-accent"},ht={class:"mt-2"},wt={class:"flex justify-between"},bt={class:"flex gap-2 mt-2"},kt={class:"col-span-12 md:col-span-9 flex flex-col justify-between"},Ct={key:0,class:"h-full"},St={key:0,class:"grid grid-cols-12 gap-4 h-fit overflow-y-visible"},Ft={key:1,class:"flex justify-center items-center h-full"},Lt={class:"flex flex-col items-center"},$t=["src"],Et={class:"flex gap-2 justify-center items-center pt-4 pb-2"},Ot={key:1,class:"flex justify-center items-center h-full"},Ut={class:"flex gap-1 justify-center py-4"},jt={class:"mt-2 flex justify-between items-center"},Vt={key:0,class:"text-sm"},Pt={key:1,class:"text-sm"},sa={__name:"index",setup(X){const{getLanguages:Y}=qe(),{getSkills:y}=Re(),{getServices:O}=Ne(),M=oe(),A=se();we();const u=f(!0),C=f(!1),S=f(!1),R=f(!1),b=f(!1),F=f(!1),k=f(null),B=f(null),j=f([]),V=f([]),r=f(1),o=f({totalPage:1,totalItems:0,itemsPerPage:4}),h=f([]),_=f(""),n=f({category:"",from:"",to:"",mainSkills:[],additionalSkills:[],fileExtensions:[],priceFrom:0,priceTo:1e6,workingHours:""}),P=a=>{B.value=a,R.value=!0},L=T(()=>j.value.filter(a=>a.id!==n.value.to.id)),I=T(()=>j.value.filter(a=>a.id!==n.value.from.id)),U=T(()=>V.value.filter(a=>a.skill_type==="main")),p=T(()=>V.value.filter(a=>a.skill_type==="additional")),m=T(()=>{const a={...n.value};return a.main_skills=n.value.mainSkills.join(","),a.additional_skills=n.value.additionalSkills.join(","),a.price_from=n.value.priceFrom,a.price_to=n.value.priceTo,a.from=n.value.from.id,a.to=n.value.to.id,a.file_extensions=n.value.fileExtensions.id,a.working_hours=n.value.workingHours,delete a.mainSkills,delete a.additionalSkills,delete a.priceFrom,delete a.priceTo,delete a.fileExtensions,delete a.workingHours,a}),x=a=>{n.value.category=a,ee(),n.value.mainSkills=[],n.value.additionalSkills=[]},ce=a=>new Intl.NumberFormat("id-ID").format(a),Z=T(()=>{const a=(r.value-1)*o.value.itemsPerPage+1,e=Math.min(r.value*o.value.itemsPerPage,o.value.totalItems);return{start:a,end:e}}),ue=async()=>{try{k.value=W("token").value.user||null}catch(a){console.error("Fetching user failed:",a)}},de=async()=>{S.value=!0;try{const{data:a}=await Y({page:1,per_page:1e4});j.value=a.data.data.map(e=>({id:e.id,name:e.name}))}catch(a){console.error("Fetching language list failed:",a)}S.value=!1},ee=async()=>{S.value=!0;try{const{data:a}=await y({page:1,per_page:1e4,merchant_type:n.value.category});V.value=a.data.data}catch(a){console.error("Fetching skill list failed:",a)}S.value=!1},H=async()=>{C.value=!0;try{const{data:a}=await O({page:r.value,per_page:o.value.itemsPerPage,search:_.value,...m.value});h.value=a.data.services.data,o.value.totalPage=a.data.services.last_page,o.value.totalItems=a.data.services.total}catch(a){console.error("Fetching services failed:",a)}finally{C.value=!1}},pe=()=>{W("token").value=null,k.value=null},te=()=>{const a={};for(const e in n.value)n.value[e]&&(Array.isArray(n.value[e])?a[e]=n.value[e].join(","):typeof n.value[e]=="object"?a[e]=n.value[e].id:a[e]=n.value[e]);return _.value&&(a.search=_.value),console.log("query:",a),a},ae=async()=>{const a=te();A.push({query:a}),await H()},me=(a,e)=>{let g;return function(...w){const N=this;clearTimeout(g),g=setTimeout(()=>{g=null,a.apply(N,w)},e)}},fe=()=>{n.value.from="",n.value.to=""};return J(F,a=>{a?b.value=!1:b.value=!0}),J(r,async()=>{await H()},{immediate:!0}),J(_,me(async()=>{r.value=1,await H()},500),{immediate:!0}),be(async()=>{M.query.search&&(_.value=M.query.search);const a=te();A.push({query:a}),await de(),await ee(),await H(),W("token").value&&await ue(),u.value=!1,window.scrollTo({top:0,behavior:"smooth"}),window.innerWidth<768&&(F.value=!0),window.addEventListener("resize",()=>{window.innerWidth<768?F.value=!0:(F.value=!1,b.value=!1)})}),(a,e)=>{const g=le,w=Fe,N=Le,G=Se,ve=$e,_e=ie,ge=Oe;return i(),d("div",Ze,[u.value?(i(),q(Ue,{key:0})):(i(),d("div",et,[s(je,{user:k.value,onLogout:pe},null,8,["user"]),t("div",tt,[t("div",at,[F.value?(i(),q(g,{key:0,icon:b.value?"i-heroicons-x-mark":"i-heroicons-adjustments-horizontal",class:"p-2 px-4 bg-accent ring-accent text-white rounded-lg hover:bg-accnet-700 transition duration-300",onClick:e[0]||(e[0]=l=>b.value=!b.value)},null,8,["icon"])):ke("",!0),K(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>_.value=l),type:"text",class:"px-4 py-2 rounded-lg border border-accent focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent w-6/12",placeholder:"Search Facilitators"},null,512),[[Ce,_.value]]),t("button",{onClick:ae,class:"px-10 py-2 bg-accent ring-accent text-white rounded-lg hover:bg-accnet-700 transition duration-300"}," Find ")]),t("div",nt,[t("div",{class:E(["md:block col-span-3",b.value?" block col-span-full":"hidden"])},[s(_e,{class:"rounded-xl",ui:{base:{},body:{base:"",background:"",padding:"sm:px-4 sm:py-2"}}},{header:c(()=>e[15]||(e[15]=[t("div",{class:"flex justify-center"},[t("h6",{class:"text-primary font-semibold text-xl uppercase"}," Filter ")],-1)])),footer:c(()=>[s(g,{block:"",class:"bg-accent",onClick:ae},{default:c(()=>e[35]||(e[35]=[$(" Apply Filter ")])),_:1})]),default:c(()=>[t("div",ot,[t("div",null,[e[19]||(e[19]=t("h6",{class:"font-semibold text-primary"},"Category",-1)),s(w,null,{default:c(()=>[t("div",st,[s(g,{variant:"outline",class:E(["flex justify-center items-center hover:bg-accent hover:text-white rounded-lg",n.value.category===""?"bg-accent text-white":""]),onClick:e[2]||(e[2]=l=>x(""))},{default:c(()=>e[16]||(e[16]=[$(" All ")])),_:1},8,["class"]),s(g,{variant:"outline",class:E(["flex justify-center items-center hover:bg-accent hover:text-white rounded-lg",n.value.category==="translator"?"bg-accent text-white":""]),onClick:e[3]||(e[3]=l=>x("translator"))},{default:c(()=>e[17]||(e[17]=[$(" Translator ")])),_:1},8,["class"]),s(g,{variant:"outline",class:E(["flex justify-center items-center hover:bg-accent hover:text-white rounded-lg",n.value.category==="interpreter"?"bg-accent text-white":""]),onClick:e[4]||(e[4]=l=>x("interpreter"))},{default:c(()=>e[18]||(e[18]=[$(" Interpreter ")])),_:1},8,["class"])])]),_:1})]),e[30]||(e[30]=t("hr",{class:"my-3"},null,-1)),t("div",null,[t("div",rt,[e[21]||(e[21]=t("h6",{class:"font-semibold text-primary"},"Languages",-1)),s(g,{variant:"link",color:"orange",onClick:fe},{default:c(()=>e[20]||(e[20]=[$(" Clear ")])),_:1})]),s(w,{label:"From",class:"py-2"},{default:c(()=>[s(N,{placeholder:"Find Your Language",options:L.value,modelValue:n.value.from,"onUpdate:modelValue":e[5]||(e[5]=l=>n.value.from=l),by:"id","option-attribute":"name","search-attributes":["name"]},null,8,["options","modelValue"])]),_:1}),s(w,{label:"To",class:"py-2"},{default:c(()=>[s(N,{placeholder:"Find Your Language",options:I.value,modelValue:n.value.to,"onUpdate:modelValue":e[6]||(e[6]=l=>n.value.to=l),by:"id","option-attribute":"name","search-attributes":["name"]},null,8,["options","modelValue"])]),_:1})]),e[31]||(e[31]=t("hr",{class:"my-3"},null,-1)),t("div",null,[t("h6",lt,v(n.value.category)+" Options ",1),S.value?(i(),d("div",ut,[s(G,{name:"i-ph-rocket-launch",dynamic:"",class:"text-xl text-gray-600"}),e[22]||(e[22]=t("span",{class:"text-gray-600"}," Loading Options... ",-1))])):(i(),q(w,{key:0},{default:c(()=>[(i(!0),d(D,null,z(U.value,l=>(i(),d("label",{key:l.id,class:"flex gap-1 py-[0.1em] w-fit"},[K(t("input",{type:"checkbox",class:"form-checkbox h-5 w-5 text-primary rounded-md",value:l.id,"onUpdate:modelValue":e[7]||(e[7]=Q=>n.value.mainSkills=Q)},null,8,it),[[ne,n.value.mainSkills]]),t("span",ct,v(l.name),1)]))),128))]),_:1}))]),t("div",dt,[e[24]||(e[24]=t("h6",{class:"font-semibold text-primary capitalize my-1"}," Additional Skills ",-1)),S.value?(i(),d("div",ft,[s(G,{name:"i-ph-rocket-launch",dynamic:"",class:"text-xl text-gray-600"}),e[23]||(e[23]=t("span",{class:"text-gray-600"}," Loading Options... ",-1))])):(i(),q(w,{key:0},{default:c(()=>[(i(!0),d(D,null,z(p.value,l=>(i(),d("label",{key:l.id,class:"flex gap-1 py-[0.1em]"},[K(t("input",{type:"checkbox",class:"form-checkbox h-5 w-5 text-primary rounded-md",value:l.id,"onUpdate:modelValue":e[8]||(e[8]=Q=>n.value.additionalSkills=Q)},null,8,pt),[[ne,n.value.additionalSkills]]),t("span",mt,v(l.name),1)]))),128))]),_:1}))]),e[32]||(e[32]=t("hr",{class:"my-3"},null,-1)),t("div",vt,[e[25]||(e[25]=t("h6",{class:"font-semibold text-primary capitalize my-1"}," File Extensions ",-1)),s(w,{class:"mb-2"},{default:c(()=>[s(N,{placeholder:"Select File Extensions",options:[{id:"pdf",name:"PDF"},{id:"doc",name:"DOC"},{id:"img",name:"IMAGE"},{id:"mp3",name:"MP3"},{id:"mp4",name:"MP4"}],modelValue:n.value.fileExtensions,"onUpdate:modelValue":e[9]||(e[9]=l=>n.value.fileExtensions=l),by:"id","option-attribute":"name","search-attributes":["name"]},null,8,["modelValue"])]),_:1})]),e[33]||(e[33]=t("hr",{class:"my-3"},null,-1)),t("div",_t,[e[26]||(e[26]=t("h6",{class:"font-semibold text-primary capitalize my-1"}," Budgets ",-1)),s(w,{class:"mb-2"},{default:c(()=>[s(ve,{min:0,step:2e4,max:1e6,modelValue:n.value.priceTo,"onUpdate:modelValue":e[10]||(e[10]=l=>n.value.priceTo=l)},null,8,["modelValue"]),t("div",gt,[t("span",xt,v(n.value.priceFrom),1),t("span",yt,"Rp."+v(ce(n.value.priceTo)),1)])]),_:1})]),e[34]||(e[34]=t("hr",{class:"my-3"},null,-1)),t("div",ht,[e[29]||(e[29]=t("h6",{class:"font-semibold text-primary capitalize my-1"}," Working Hours ",-1)),t("div",wt,[s(w,null,{default:c(()=>[t("div",bt,[s(g,{variant:"outline",class:E(["flex justify-center items-center hover:bg-accent hover:text-white rounded-lg",n.value.workingHours==="anytime"?"bg-accent text-white":""]),onClick:e[11]||(e[11]=l=>n.value.workingHours="anytime")},{default:c(()=>e[27]||(e[27]=[$(" Anytime ")])),_:1},8,["class"]),s(g,{variant:"outline",class:E(["flex justify-center items-center hover:bg-accent hover:text-white rounded-lg",n.value.workingHours==="special"?"bg-accent text-white":""]),onClick:e[12]||(e[12]=l=>n.value.workingHours="special")},{default:c(()=>e[28]||(e[28]=[$(" Special Time ")])),_:1},8,["class"])])]),_:1})])])])]),_:1})],2),t("div",kt,[C.value?(i(),d("div",Ot,[t("div",Ut,[s(G,{name:"i-ph-rocket-launch",dynamic:"",class:"text-xl text-gray-600"}),e[38]||(e[38]=t("span",{class:"text-gray-600"}," Loading Facilitators... ",-1))])])):(i(),d("div",Ct,[h.value.length>0?(i(),d("div",St,[(i(!0),d(D,null,z(h.value,l=>(i(),q(Ke,{class:"col-span-12 sm:col-span-6",key:l.id,data:l,onOrder:Q=>P(l)},null,8,["data","onOrder"]))),128))])):(i(),d("div",Ft,[t("div",Lt,[t("img",{src:re(Xe),width:"200px",alt:""},null,8,$t),t("div",Et,[s(G,{name:"i-heroicons-exclamation-triangle",class:"text-2xl text-gray-800"}),e[36]||(e[36]=t("span",{class:"text-gray-800 text-xl font-semibold"}," No Data Found... ",-1))]),e[37]||(e[37]=t("span",{class:"text-gray-600"}," Please try another filter or search query ",-1))])]))])),t("div",jt,[o.value.totalItems!==0?(i(),d("span",Vt," Showing "+v(Z.value.start)+" to "+v(Z.value.end)+" of "+v(o.value.totalItems)+" entries ",1)):(i(),d("span",Pt," No Items 0 / 0 ")),s(ge,{modelValue:r.value,"onUpdate:modelValue":e[13]||(e[13]=l=>r.value=l),"page-count":1,total:o.value.totalPage},null,8,["modelValue","total"])])])])])])),s(Te,{isOpen:R.value,data:B.value,onHide:e[14]||(e[14]=l=>R.value=!1)},null,8,["isOpen","data"])])}}};export{sa as default};

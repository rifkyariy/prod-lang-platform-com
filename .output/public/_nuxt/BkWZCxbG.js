import{x as _e,r as m,f as ve,h as ke,c as p,b as l,w as c,i,j as be,o as u,d as k,a as t,F as P,s as j,l as H,t as v,k as ye,y as xe,z as V,A as F,B as he,m as W,q as we,C as Pe,p as je}from"./XJk57Xzm.js";import{_ as Se}from"./BNtHcZP4.js";import{_ as Ae}from"./0oq0bqkJ.js";import{_ as Ce}from"./CBafb-BA.js";import{_ as Ue}from"./CrKBm7Us.js";import{_ as Ne}from"./BFtfbmKc.js";import{_ as Ve}from"./viV4BwKR.js";import{_ as $e}from"./7oWaGxPY.js";import"./DEmq8X_o.js";import"./BQdhZYq_.js";import"./DKK-teFl.js";import"./Y56T3AGQ.js";const Me=()=>{const{$axios:g}=_e();return{getAdsPackages(){return g.get("/advertisement-packages")},getAdsPackageDetail(d){return g.get(`/packages/${d}`)},createAdsPackage(d){return g.post("/advertisement-packages",d)},updateAdsPackage(d,S){return g.put(`/advertisement-packages/${d}`,S)},deleteAdsPackage(d){return g.delete(`/advertisement-packages/${d}`)},getSubsPackages(){return g.get("/subscriptions-packages")},getSubsPackageDetail(d){return g.get(`/subscriptions-packages/${d}`)},createSubsPackage(d){return g.post("/subscriptions-packages",d)},updateSubsPackage(d,S){return g.put(`/subscriptions-packages/${d}`,S)},deleteSubsPackage(d){return g.delete(`/subscriptions-packages/${d}`)}}},Oe={key:0,class:"text-gray-500 flex justify-center items-center h-full gap-2"},De={key:1,class:"w-full pt-0 p-6 flex flex-col gap-2"},Re={class:"grid grid-cols-2 gap-2"},Be={class:"flex flex-col gap-2"},He={class:"flex justify-between w-full"},Fe={class:"font-semibold flex gap-1 items-center"},Le={class:"flex justify-end"},Te={class:"flex flex-col gap-4 w-full"},Ie={class:"flex flex-col w-full"},Ee={class:"flex justify-between w-full items-center"},ze={class:"font-semibold text-xl flex items-center gap-1"},Je={class:"flex gap-1"},qe={class:"font-semibold text-accent"},Ke={class:"py-4"},Ge={class:"flex flex-col gap-2"},Qe={class:"flex justify-between w-full"},We={class:"font-semibold flex gap-1 items-center"},Xe={class:"flex justify-end"},Ye={class:"flex flex-col gap-4 w-full"},Ze={class:"flex flex-col w-full"},et={class:"flex justify-between w-full items-center"},tt={class:"font-semibold text-xl flex items-center gap-1"},st={class:"flex gap-1"},at={class:"font-semibold text-accent"},ot={class:"pb-4"},nt={class:"flex justify-between items-center"},lt={class:"font-semibold"},it={class:"p-2"},rt={class:"flex flex-col gap-4"},ct={key:0},ut={class:"flex flex-col gap-2"},dt=["value"],pt={class:"ml-2 text-gray-700"},mt={key:1},ft={class:"flex gap-2 items-center mb-2"},gt={key:0,class:"flex flex-wrap gap-2"},_t={class:"text-sm"},vt={key:1,class:"text-gray-400 py-1"},kt={class:"mt-4 flex justify-end"},Vt={__name:"packages",setup(g){const{getSubsPackages:d,updateSubsPackage:S,createSubsPackage:X,deleteSubsPackage:Y,getAdsPackages:Z,createAdsPackage:ee,updateAdsPackage:te,deleteAdsPackage:se}=Me(),A=m(!0),b=m(!1),$=m(!1),M=m(!1),y=m(!1),L=m({}),f=ve(),O=m("subs"),T=m([]),I=m([]),E=m([{id:1,name:"Homepage",route:"/"},{id:2,name:"Packages",route:"/packages"},{id:3,name:"Facilitator",route:"/facilitators"}]),C=m([{id:1,name:"Can open a stall on the website according to the tang package they choose",rule:{name:"is_stall",value:!0}},{id:2,name:"Online lias life shop",rule:{name:"is_online_shop",value:!0}},{id:3,name:"Reviews appear",rule:{name:"is_reviewed",value:!0}},{id:4,name:"Advertised (the shop appears at the top or most recommended)",rule:{name:"is_advertised",value:!0}},{id:5,name:"Free Shipping",rule:{name:"is_free_shipping",value:!0}}]),ae=m({}),o=m({name:"",desc:"",duration:1,price:1e4,priority:1,rule_json:[],route_json:[{id:1,name:"Homepage",route:"/"}]}),z=s=>s.match(/"([^"]+)"/g).map(e=>e.replace(/"/g,"")),J=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s),U=async()=>{const{data:s}=await d();T.value=s.data.packages.map(e=>({id:e.id,name:e.name,desc:z(e.desc),duration:e.duration,price:e.price,rule_json:C.value.map(a=>{const r=z(e.desc).find(_=>_.includes(a.name));return{...a,rule:{...a.rule,value:!!r}}})})),A.value=!1},N=async()=>{const{data:s}=await Z();I.value=s.data.packages.map(e=>({id:e.id,name:e.name,route_json:e.route_json,duration:e.duration,price:e.price})),A.value=!1},q=s=>s>1?s+" Months":s+" Month",K=(s,e)=>{s==="subs"?o.value={...e,rule_json:e.rule_json.map((a,r)=>(console.log(a.rule),a.rule.value?r+1:null)),route_json:[]}:o.value={...e,rule_json:[],route_json:E.value.filter(a=>e.route_json.map(r=>r.id).includes(a.id))},D(s,!0)},D=(s,e=!1)=>{O.value=s,M.value=e,e?o.value.type=s:o.value={name:"",desc:"",duration:1,price:1e4,priority:1,rule_json:[],route_json:[{id:1,name:"Homepage",route:"/"}],type:s},y.value=!0},w=s=>{const a=Object.keys(s)[0];return s[a][0]},G=(s,e,a,r,_)=>{L.value={title:s,content:e,confirmText:a,cancelText:r,callback:_},$.value=!0},oe=async()=>{b.value=!0,M.value?await re():await ne()},ne=async()=>{if(o.value.type==="subs"){let s=[];const e=C.value.map(a=>{const r=o.value.rule_json.includes(a.id);return r?(s.push(a.name),{...a.rule,value:r}):{...a.rule,value:!1}});o.value.desc=JSON.stringify(s),o.value.rule_json=e,await le(o.value)}else await ie(o.value)},le=async s=>{await X(s).then(e=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"New Subscription Package created successfully!"}),o.value={name:"",duration:1,price:1e4,rule_json:[]},y.value=!1,U()}).catch(e=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(e.response.data.error)})}).finally(()=>{b.value=!1})},ie=async s=>{await ee(s).then(e=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"New Ads Package created successfully!"}),o.value={name:"",duration:1,price:1e4,priority:1,rule_json:[],route_json:[{id:1,name:"Homepage",route:"/"}]},y.value=!1,N()}).catch(e=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(e.response.data.error)})}).finally(()=>{b.value=!1})},re=async()=>{if(o.value.type==="subs"){let s=[];const e=C.value.map(a=>{const r=o.value.rule_json.includes(a.id);return r?(s.push(a.name),{...a.rule,value:r}):{...a.rule,value:!1}});o.value.desc=JSON.stringify(s),o.value.rule_json=e,await ce(o.value)}else await ue(o.value)},ce=async s=>{await S(s.id,s).then(e=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Subscription Package updated successfully!"}),o.value={name:"",duration:1,price:1e4,rule_json:[]},y.value=!1,U()}).catch(e=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(e.response.data.error)})}).finally(()=>{b.value=!1})},ue=async s=>{await te(s.id,s).then(e=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Ads Package updated successfully!"}),o.value={name:"",duration:1,price:1e4,priority:1,rule_json:[],route_json:[{id:1,name:"Homepage",route:"/"}]},y.value=!1,N()}).catch(e=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(e.response.data.error)})}).finally(()=>{b.value=!1})},Q=async(s,e)=>{b.value=!0,ae.value={id:e},s==="subs"?await Y(e).then(a=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Package deleted successfully!"}),U()}).catch(a=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(a.response.data.error)})}).finally(()=>{b.value=!1}):await se(e).then(a=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Package deleted successfully!"}),N()}).catch(a=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(a.response.data.error)})}).finally(()=>{b.value=!1}),$.value=!1};return ke(()=>{A.value=!0,U(),N()}),(s,e)=>{const a=Pe,r=je,_=Se,R=Ae,de=Ce,pe=Ue,me=Ne,fe=Ve,ge=be;return u(),p("div",null,[l(ge,{name:"admin"},{default:c(()=>[i(A)?(u(),p("div",Oe,[l(a,{name:"i-ph-rocket-launch",dynamic:"",class:"text-xl text-gray-600"}),e[10]||(e[10]=k(" Loading Packages... "))])):(u(),p("div",De,[t("div",Re,[t("div",Be,[l(_,{ui:{base:"w-full",body:{base:"flex justify-between items-center",background:"",padding:"p-2 sm:p-4"}}},{default:c(()=>[t("div",He,[t("h6",Fe,[l(a,{name:"i-heroicons-sparkles"}),e[11]||(e[11]=k(" Subscription Packages "))]),t("div",Le,[l(r,{variant:"soft",color:"blue",onClick:e[0]||(e[0]=n=>D("subs"))},{default:c(()=>[l(a,{name:"i-heroicons-plus-circle"}),e[12]||(e[12]=k(" Add New Package "))]),_:1})])])]),_:1}),l(_,{ui:{body:{base:"flex justify-between items-center",background:"",padding:"p-2 sm:p-6"}}},{default:c(()=>[t("div",Te,[(u(!0),p(P,null,j(i(T),(n,x)=>(u(),H(_,{key:x,ui:{body:{base:"w-full flex justify-between items-center flex-grow",background:"",padding:"p-2 sm:p-4"}}},{default:c(()=>[t("div",Ie,[t("div",Ee,[t("h6",ze,[l(a,{name:"i-heroicons-bolt"}),k(" "+v(n.name)+" ("+v(q(n.duration))+") ",1)]),t("div",Je,[l(r,{variant:"soft",color:"blue",onClick:h=>K("subs",n)},{default:c(()=>[l(R,{name:"edit"})]),_:2},1032,["onClick"]),l(r,{variant:"soft",color:"red",onClick:h=>{G("Hang On","Are you sure you want to delete this package ?","Delete","Cancel",()=>{Q("subs",n.id)})}},{default:c(()=>[l(a,{name:"i-heroicons-trash"})]),_:2},1032,["onClick"])])]),t("span",qe,v(J(n.price)),1),t("ol",Ke,[(u(!0),p(P,null,j(n.desc,(h,B)=>(u(),p("li",{key:B,class:"flex gap-2 items-start"},[l(R,{name:"check-package",class:"pt-1"}),k(" "+v(h),1)]))),128))])])]),_:2},1024))),128))])]),_:1})]),t("div",Ge,[l(_,{ui:{base:"w-full",body:{base:"flex justify-between items-center",background:"",padding:"p-2 sm:p-4"}}},{default:c(()=>[t("div",Qe,[t("h6",We,[l(a,{name:"i-heroicons-megaphone"}),e[13]||(e[13]=k(" Ads Packages "))]),t("div",Xe,[l(r,{variant:"soft",color:"blue",onClick:e[1]||(e[1]=n=>D("ads"))},{default:c(()=>[l(a,{name:"i-heroicons-plus-circle"}),e[14]||(e[14]=k(" Add New Package "))]),_:1})])])]),_:1}),l(_,{ui:{body:{base:"flex justify-between items-center",background:"",padding:"p-2 sm:p-6"}}},{default:c(()=>[t("div",Ye,[(u(!0),p(P,null,j(i(I),(n,x)=>(u(),H(_,{key:x,ui:{body:{base:"w-full flex justify-between items-center flex-grow",background:"",padding:"p-2 sm:p-4"}}},{default:c(()=>[t("div",Ze,[t("div",et,[t("h6",tt,[l(a,{name:"i-heroicons-bolt"}),k(" "+v(n.name)+" ("+v(q(n.duration))+") ",1)]),t("div",st,[l(r,{variant:"soft",color:"blue",onClick:h=>K("ads",n)},{default:c(()=>[l(R,{name:"edit"})]),_:2},1032,["onClick"]),l(r,{variant:"soft",color:"red",onClick:h=>{G("Hang On","Are you sure you want to delete this package ?","Delete","Cancel",()=>{Q("ads",n.id)})}},{default:c(()=>[l(a,{name:"i-heroicons-trash"})]),_:2},1032,["onClick"])])]),t("span",at,v(J(n.price)),1),e[15]||(e[15]=t("span",{class:"font-semibold"}," Halaman : ",-1)),t("ol",ot,[(u(!0),p(P,null,j(n.route_json,(h,B)=>(u(),p("li",{key:B,class:"flex gap-2 items-center"},[l(a,{name:"i-heroicons-globe-alt",class:"pt-1"}),k(" "+v(h.name),1)]))),128))])])]),_:2},1024))),128))])]),_:1})])]),l(fe,{modelValue:i(y),"onUpdate:modelValue":e[9]||(e[9]=n=>ye(y)?y.value=n:null),ui:{width:"w-full sm:max-w-2xl"},"prevent-close":""},{default:c(()=>[l(_,null,{default:c(()=>[t("div",nt,[t("h6",lt,v(i(M)?"Edit":"Add New")+" Package ",1),l(r,{variant:"soft",color:"red",icon:"i-heroicons-x-circle",onClick:e[2]||(e[2]=n=>y.value=!1)})]),t("div",it,[t("form",{onSubmit:xe(oe,["prevent"])},[t("div",rt,[t("div",null,[e[16]||(e[16]=t("label",{for:"newName",class:"block text-sm font-medium text-gray-700 pb-2"}," Package Name ",-1)),V(t("input",{type:"text",id:"newName",placeholder:"Package Name","onUpdate:modelValue":e[3]||(e[3]=n=>i(o).name=n),class:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2"},null,512),[[F,i(o).name]])]),t("div",null,[e[17]||(e[17]=t("label",{for:"newDuration",class:"block text-sm font-medium text-gray-700 pb-2"}," Package Duration (Month) ",-1)),V(t("input",{type:"number",id:"newDuration",placeholder:"Package Duration","onUpdate:modelValue":e[4]||(e[4]=n=>i(o).duration=n),class:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2"},null,512),[[F,i(o).duration]])]),t("div",null,[e[18]||(e[18]=t("label",{for:"newPrice",class:"block text-sm font-medium text-gray-700 pb-2"}," Package Price ",-1)),V(t("input",{type:"number",id:"newPrice",placeholder:"Package Price","onUpdate:modelValue":e[5]||(e[5]=n=>i(o).price=n),class:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2"},null,512),[[F,i(o).price]])]),i(O)==="subs"?(u(),p("div",ct,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 pb-2"}," Package Rule ",-1)),t("div",ut,[(u(!0),p(P,null,j(i(C),n=>(u(),p("label",{key:n.id,class:"flex gap-1 py-[0.1em] w-fit"},[V(t("input",{type:"checkbox",class:"form-checkbox h-5 w-5 text-primary rounded-md",value:n.id,"onUpdate:modelValue":e[6]||(e[6]=x=>i(o).rule_json=x)},null,8,dt),[[he,i(o).rule_json]]),t("span",pt,v(n.name)+".",1)]))),128))])])):W("",!0),i(O)==="ads"?(u(),p("div",mt,[e[22]||(e[22]=t("label",{for:"newPriority",class:"block text-sm font-medium text-gray-700 pb-2"}," Priority ",-1)),t("div",ft,[e[20]||(e[20]=t("span",{class:"block text-sm font-medium text-gray-700"}," Less ",-1)),l(de,{modelValue:i(o).priority,"onUpdate:modelValue":e[7]||(e[7]=n=>i(o).priority=n),step:1,min:1,max:3},null,8,["modelValue"]),e[21]||(e[21]=t("span",{class:"block text-sm font-medium text-gray-700"}," More ",-1))]),e[23]||(e[23]=t("label",{for:"newRoute",class:"block text-sm font-medium text-gray-700 pb-2"}," Package Route ",-1)),l(me,{modelValue:i(o).route_json,"onUpdate:modelValue":e[8]||(e[8]=n=>i(o).route_json=n),searchable:"",options:i(E),placeholder:"Select Ads Show Page","option-attribute":"name",multiple:"",trailing:"",by:"id",ui:{base:"w-full py-2 outline-none border-none",ring:"ring-0"}},{default:c(()=>[l(r,{color:"gray",class:"flex-1 justify-between"},{default:c(()=>[i(o).route_json.length>0?(u(),p("div",gt,[(u(!0),p(P,null,j(i(o).route_json,(n,x)=>(u(),H(pe,{key:x,color:"blue",variant:"soft"},{default:c(()=>[t("span",_t,v(n.name),1)]),_:2},1024))),128))])):(u(),p("span",vt," Select Ads Show Page ")),l(a,{name:"i-heroicons-chevron-down-20-solid",class:we(["w-5 h-5 transition-transform text-gray-400 dark:text-gray-500",[s.open&&"transform rotate-90"]])},null,8,["class"])]),_:1})]),_:1},8,["modelValue","options"])])):W("",!0)]),t("div",kt,[l(r,{loading:i(b),type:"submit",variant:"soft",color:"blue"},{default:c(()=>e[24]||(e[24]=[k(" Save ")])),_:1},8,["loading"])])],32)])]),_:1})]),_:1},8,["modelValue"])]))]),_:1}),l($e,{isOpen:i($),data:i(L)},null,8,["isOpen","data"])])}}};export{Vt as default};

import{_ as de}from"./CizdsbHW.js";import{f as me,E as pe,D as fe,r as f,Q as E,g as _e,h as ve,G as S,c as d,z as xe,a4 as ge,a as t,b as o,F as I,s as T,i as A,w as i,m,l as g,p as ye,o as n,t as c,q as z,d as v,C as he,v as be}from"./BEkH225l.js";import{_ as ke}from"./DswlE1Sz.js";import{_ as we}from"./Bk0utM0A.js";import{_ as Ce}from"./C0jI5ihE.js";import{_ as De}from"./DVmWxMly.js";import{P as Fe}from"./BP8UTi2G.js";import{_ as $e}from"./Bizv0OyU.js";import{_ as Y}from"./DZJ46zT2.js";import{u as Se}from"./CtX79Qbr.js";import{u as Oe}from"./CQA2cOXQ.js";import"./DJQezgFW.js";import"./BNh9XT_a.js";import"./DwxjmMYL.js";import"./E4AWPTk2.js";import"./u12rnr9u.js";import"./x_mdr1ZB.js";const je={class:"w-100 flex flex-col items-center"},Ue={class:"flex justify-between items-stretch w-10/12 my-16 gap-16 px-8 pt-16"},Pe={class:"w-2/12"},Ie={class:"flex flex-col items-start mt-4"},Te={class:"text-md text-primary"},ze={key:0,class:"w-10/12"},Me={class:"flex gap-2 items-center mb-3"},Ne={class:"flex justify-between items-center"},Be={class:"flex items-center gap-2 capitalize"},Le={class:"font-semibold"},Re={class:"flex justify-between items-center gap-2"},Ve={class:"capitalize"},Ee={class:"flex gap-3 justify-between items-center px-2"},Ae={class:"flex gap-3 w-7/12"},Ye={class:"flex flex-col gap-1"},qe={class:"font-semibold text-primary"},He={class:""},Je={class:"text-sm text-gray-700"},We={class:"text-sm text-gray-700"},Ge={key:0},Qe={key:0,class:"mt-4 flex flex-col items-end gap-2"},Ke={key:1,class:"mt-4 flex flex-col items-end gap-2"},Xe={key:1,class:"flex flex-col text-right items-end"},Ze={class:"font-semibold text-primary text-lg my-1"},et={class:"font-thin text-primary text-sm"},tt={class:"font-bold text-primary text-md text-xl py-2 flex gap-2 items-center uppercase"},st={class:"font-thin text-primary text-sm mb-2"},ot={key:2,class:"flex flex-col text-right items-end"},at={key:0,class:"mt-4 flex flex-col gap-2"},lt={key:0,class:"mt-6"},nt={key:0,class:"pb-4"},it={class:"flex gap-2 items-center"},rt={class:"flex flex-col items-start gap-1"},ct={class:"font-semibold"},ut={class:"flex text-gray-700 my-3 text-sm"},dt={class:"text-gray-700 text-sm"},mt={key:1,class:"pb-4"},pt={class:"flex gap-2 items-center"},ft={class:"flex text-gray-700 my-3 text-sm"},_t={class:"text-gray-700 text-sm"},vt={class:"flex justify-end border-t border-1 pt-2 gap-2"},zt={__name:"[id]",setup(xt){const y=me(),M=pe(),N=fe(),{getDetailOrder:q,updateMyOrder:B}=Se(),{getSettingBank:H}=Oe(),J=[{key:"order-history",label:"Order History",icon:"user-circle",scope:"all"}],W=f({title:"",content:"",confirmText:"",cancelText:"",callback:null}),D=f(!0),G=f(!1),O=f(!1),F=f("order-history"),_=f({fullname:"",photo:"",email:"",phone:"",address:"",role:"",personal_description:"",main_skills:[],additional_skills:[],is_admin:!1,is_facilitator:!1}),k=f({bank_name:"",bank_account:"",bank_account_name:""}),L=f([]),j=f(3),w=f([]),h=f({user:{fullname:"You",photo:"/images/avatar.jpg"},message:"",time:new Date().toISOString(),file_url:"",other_link:"",is_facilitator:!1}),Q=E(()=>{if(!_.value)return[];const s=_.value.is_admin??!1,e=_.value.is_facilitator??!1;return J.filter(u=>u.scope==="all"||u.scope==="admin"&&s||u.scope==="merchant"&&e)}),K=E(()=>w.value.slice(-(j.value??3))),R=s=>{switch(s){case"completed":return{color:"green",text:"Completed"};case"paid":return{color:"blue",text:"In Progress"};case"pending":return{color:"violet",text:"Pending"};case"waitingpaid":return{color:"orange",text:"Waiting Payment & Verification"};case"failed":return{color:"red",text:"Failed"};default:return{color:"gray",text:"Unknown"}}},X=s=>{navigator.clipboard.writeText(s),y.add({title:"Copied!",color:"green",icon:"i-heroicons-check-circle",description:"No Rekening copied to clipboard!"})},C=s=>{window.open(s,"_blank")},Z=s=>{N.push(s)},V=s=>{const e=new Date,u=new Date(s),r=Math.floor((e-u)/1e3),p={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};for(const b in p){const x=Math.floor(r/p[b]);if(x>=1)return x===1?`${x} ${b} ago`:`${x} ${b}s ago`}return"just now"},ee=()=>{console.log("Logging out..."),S("token").value=null,_.value={fullname:"",photo:"",email:"",phone:"",address:"",role:"",personal_description:"",main_skills:[],additional_skills:[],is_admin:!1,is_facilitator:!1}},te=s=>{try{return JSON.parse(s)}catch{return s}},se=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s),U=async()=>{const s=M.params.id;try{const{data:e}=await q(s);L.value=[e.data.order],w.value=te(e.data.order.comment_json)??[]}catch(e){console.error("Fetching orders failed:",e)}},oe=s=>{console.log("File uploaded:",s),h.value.file_url=s};_e(()=>F.value,s=>{s==="service"&&S("token").value.user.merchant_status==="pending"&&N.push({name:"my-merchant-status"})});const ae=async()=>{try{_.value=S("token").value.user||null,h.value.user={fullname:_.value.fullname,photo:_.value.photo}}catch(s){console.error("Fetching user failed:",s)}},le=async(s,e)=>{const u=w.value??[];if(!e.message&&e.file_url&&(e.message="Here I attached a file."),!e.message&&!e.file_url){y.add({title:"Failed!",color:"red",icon:"i-heroicons-x-circle",description:"Comment message is required!"});return}u.push(e);try{const{data:r}=await B(s,{comment_json:u});y.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Order updated successfully!"}),await U(),h.value={user:{fullname:_.value.fullname,photo:_.value.photo},message:"",time:new Date().toISOString(),file_url:"",other_link:"",is_facilitator:!1}}catch(r){console.error("Updating order failed:",r),y.add({title:"Failed!",color:"red",icon:"i-heroicons-x-circle",description:"Failed to update order!"})}},ne=async s=>{const e=M.params.id;try{const{data:u}=await B(e,{payment_file_url:s});y.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Order updated successfully!"}),await U()}catch(u){console.error("Updating order failed:",u),y.add({title:"Failed!",color:"red",icon:"i-heroicons-x-circle",description:"Failed to update order!"})}},ie=async()=>{try{const{data:s}=await H();k.value=s.data.setting}catch(s){console.error("Error fetching bank data:",s)}finally{D.value=!1}};return ve(async()=>{S("token").value&&(await ae(),await U(),await ie()),D.value=!1,window.scrollTo({top:0,behavior:"smooth"})}),(s,e)=>{const u=de,r=ye,p=he,b=ke,x=be,$=we,re=Ce,ce=De;return n(),d("div",null,[xe(t("div",je,[o($e,{user:_.value,onLogout:ee,class:"w-full"},null,8,["user"]),t("div",Ue,[t("div",Pe,[e[5]||(e[5]=t("h6",{class:"font-semibold"},"Client Dashboard",-1)),t("div",Ie,[(n(!0),d(I,null,T(A(Q),(a,P)=>(n(),g(r,{key:P,block:"",class:z(["py-3 px-3.5 flex justify-start bg-white hover:bg-[#FDF1EE] shadow-none",F.value===a.key?"bg-[#FDF1EE]":"bg-white"]),onClick:l=>F.value=a.key},{default:i(()=>[o(u,{name:a.icon,class:"text-2xl text-primary"},null,8,["name"]),t("span",Te,c(a.label),1)]),_:2},1032,["class","onClick"]))),128))])]),F.value==="order-history"?(n(),d("div",ze,[t("div",Me,[o(r,{variant:"link",onClick:e[0]||(e[0]=a=>Z({name:"my-client-orders"}))},{default:i(()=>[o(u,{name:"chevron-left"})]),_:1}),e[6]||(e[6]=t("h6",{class:"font-semibold"},"Detail Order",-1))]),(n(!0),d(I,null,T(L.value,(a,P)=>(n(),g($,{key:P,ui:{header:{padding:"px-4 py-2 sm:px-3"},body:{padding:"px-4 py-0  sm:p-3"}},class:"p-2"},{header:i(()=>[t("div",Ne,[t("div",Be,[o(p,{name:"i-heroicons-language"}),t("span",Le,c(a.merchant.type),1)]),t("div",Re,[o(b,{variant:"soft",color:R(a.order_status).color},{default:i(()=>[t("span",Ve,c(R(a.order_status).text),1)]),_:2},1032,["color"]),o(r,{variant:"link"},{default:i(()=>[o(u,{name:"dots",class:"text-md text-primary"})]),_:1})])])]),default:i(()=>[t("div",Ee,[t("div",Ae,[t("div",Ye,[o(x,{alt:a.merchant_user.fullname,src:a.merchant_user.photo,size:"xl",imgClass:"object-cover",class:"mb-2"},null,8,["alt","src"]),t("span",qe,c(a.merchant_user.fullname),1),t("div",He,[t("span",Je,[v(c(a.service.name)+" Service ",1),e[7]||(e[7]=t("br",null,null,-1))]),t("span",We," ("+c(a.language_source.name)+" - "+c(a.language_destination.name)+") ",1)])])]),a.order_status==="completed"?(n(),d("div",Ge,[a.result_file_url?(n(),d("div",Qe,[e[9]||(e[9]=t("span",{class:"font-semibold text-sm pb-1"}," Download Result ",-1)),o(r,{color:"primary",class:"text-white",onClick:l=>C(a.result_file_url)},{default:i(()=>[o(p,{name:"i-heroicons-arrow-down-tray"}),e[8]||(e[8]=v(" Download "))]),_:2},1032,["onClick"])])):m("",!0),a.meet_url?(n(),d("div",Ke,[e[11]||(e[11]=t("span",{class:"font-semibold text-sm pb-1"},"Meeting Link",-1)),o(r,{color:"primary",onClick:l=>C(a.meet_url)},{default:i(()=>[o(p,{name:"i-heroicons-video-camera"}),e[10]||(e[10]=v(" Open Meeting Url "))]),_:2},1032,["onClick"])])):m("",!0)])):m("",!0),a.order_status==="waitingpaid"?(n(),d("div",Xe,[e[13]||(e[13]=t("span",{class:"font-thin text-primary text-sm"}," Amount to be transfer : ",-1)),t("h6",Ze,c(se(a.price)),1),t("span",et,c(k.value.bank_account_name),1),t("h6",tt,[v(c(k.value.bank_account)+" ("+c(k.value.bank)+") ",1),o(r,{size:"xs",variant:"outline",color:"blue",onClick:e[1]||(e[1]=l=>X(k.value.bank_account)),class:""},{default:i(()=>[o(u,{name:"copy",class:"text-lg"})]),_:1})]),t("span",st,c(a.payment_file_url?"Re":"")+" Upload Proof of Payment ",1),O.value||!a.payment_file_url?(n(),g(Y,{key:0,title:"Proof of Payment",accept:"*",center:!0,"max-size":"6291456",onFileUploaded:ne})):m("",!0),!O.value&&a.payment_file_url?(n(),g(r,{key:1,color:"primary",class:"text-white",onClick:e[2]||(e[2]=l=>O.value=!0)},{default:i(()=>[o(p,{name:"i-heroicons-arrow-path"}),e[12]||(e[12]=v(" Reupload "))]),_:1})):m("",!0)])):m("",!0),a.order_status==="paid"?(n(),d("div",ot,[e[16]||(e[16]=t("span",{class:"font-semibold text-xl pb-2"},"Work In Progress",-1)),e[17]||(e[17]=t("p",{class:"w-7/12 text-gray-600 text-sm"}," Your order has been received and is now being processed. Thank you for your trust in using our services. ",-1)),a.meet_url?(n(),d("div",at,[e[15]||(e[15]=t("span",{class:"font-semibold text-sm pb-1"},"Meeting Link",-1)),o(r,{color:"primary",onClick:l=>C(a.meet_url)},{default:i(()=>[o(p,{name:"i-heroicons-video-camera"}),e[14]||(e[14]=v(" Open Meeting Url "))]),_:2},1032,["onClick"])])):m("",!0)])):m("",!0)]),a.order_status==="paid"||a.order_status==="completed"?(n(),d("div",lt,[e[24]||(e[24]=t("h6",{class:"font-semibold mb-2"},"Discussions",-1)),j.value<w.value.length?(n(),g(r,{key:0,block:"",color:"primary",variant:"soft",class:"my-4 bg-blue-100 hover:bg-blue-200",onClick:e[3]||(e[3]=l=>j.value=w.value.length)},{default:i(()=>[o(p,{name:"i-heroicons-chat-bubble-oval-left-ellipsis"}),e[18]||(e[18]=v(" Load Previous Comments "))]),_:1})):m("",!0),(n(!0),d(I,null,T(A(K),l=>(n(),d("div",{key:l},[l.is_facilitator?(n(),d("div",nt,[o($,{ui:{body:{base:"w-full",padding:"p-4 sm:p-4"}},class:"flex gap-4 items-center w-full"},{default:i(()=>[t("div",it,[o(x,{alt:l.user.fullname,src:l.user.photo,size:"md",imgClass:"object-cover"},null,8,["alt","src"]),t("div",rt,[t("span",ct,c(l.user.fullname),1),o(b,{variant:"soft",size:"xs",color:"blue"},{default:i(()=>e[19]||(e[19]=[t("span",{class:"capitalize"}," Faciliator ",-1)])),_:1})])]),t("div",ut,c(l.message),1),t("div",{class:z(["flex items-center",l.file_url?"justify-between":"justify-end"])},[l.file_url?(n(),g(r,{key:0,color:"green",variant:"soft",onClick:ue=>C(l.file_url)},{default:i(()=>[o(p,{name:"i-heroicons-arrow-down-tray"}),e[20]||(e[20]=v(" Attached File "))]),_:2},1032,["onClick"])):m("",!0),t("span",dt,c(V(new Date(l.time))),1)],2)]),_:2},1024)])):(n(),d("div",mt,[o($,{ui:{body:{base:"w-full",padding:"p-4 sm:p-4"}},class:"flex gap-4 items-center w-ful bg-blue-50"},{default:i(()=>[t("div",pt,[o(x,{alt:l.user.fullname,src:l.user.photo,size:"md",imgClass:"object-cover"},null,8,["alt","src"]),e[21]||(e[21]=t("div",{class:"flex flex-col items-start gap-1"},[t("span",{class:"font-semibold text-primary"}," You ")],-1))]),t("div",ft,c(l.message),1),t("div",{class:z(["flex items-center",l.file_url?"justify-between":"justify-end"])},[l.file_url?(n(),g(r,{key:0,color:"green",variant:"soft",onClick:ue=>C(l.file_url)},{default:i(()=>[o(p,{name:"i-heroicons-arrow-down-tray"}),e[22]||(e[22]=v(" Attached File "))]),_:2},1032,["onClick"])):m("",!0),t("span",_t,c(V(new Date(l.time),{addSuffix:!0})),1)],2)]),_:2},1024)]))]))),128)),o($,{ui:{body:{base:"w-full",padding:"p-4 sm:p-2"}},class:"flex gap-4 items-center w-full"},{default:i(()=>[o(re,{modelValue:h.value.message,"onUpdate:modelValue":e[4]||(e[4]=l=>h.value.message=l),class:"w-full mb-2",placeholder:"Add Comment...",variant:"none"},null,8,["modelValue"]),t("div",vt,[o(Y,{"is-display-file":!1,accept:"*","max-size":"6291456",onFileUploaded:oe}),o(r,{color:"primary",onClick:l=>le(a.id,h.value)},{default:i(()=>[o(p,{name:"i-heroicons-paper-airplane"}),e[23]||(e[23]=v(" Send "))]),_:2},1032,["onClick"])])]),_:2},1024)])):m("",!0)]),_:2},1024))),128))])):m("",!0)])],512),[[ge,!D.value]]),D.value?(n(),g(Fe,{key:0})):m("",!0),o(ce,{isOpen:G.value,data:W.value},null,8,["isOpen","data"])])}}};export{zt as default};
